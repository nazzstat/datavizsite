---
title: 'QAC 251: Homework Assignment 2'
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo =TRUE , eval=TRUE, fig.height=3, warning=FALSE, message=FALSE)
```


#### Instructions: Please be sure to answer questions with relevant code and written arguments (when necessary). Submit your assignment as an html file in moodle.

#Question 1

Data from the US Census Bureau's American Housing Survey (AHS) which contains information about housing and living conditions for samples from certain metropolitan areas. These data were extracted from respondents in the Atlanta and St. Louis metropolitan area. They include only cases where the respondent worked somewhere other than home. Values show the time (in minutes) and distance (in miles) that respondents typically traveled on their commute to work each day as well as age and sex. 

+ *City*:	Atlanta or St. Louis
+ *Age*:	Age of the respondent (in years)
+ *Distance*:	Commute distance (in miles)
+ *Time*:	Commute time (in minutes)
+ *Sex*:	F or M

```{r, echo=TRUE}
Commuter<-read.csv("https://raw.githubusercontent.com/nazzstat/DataVisualization/master/Commuter.csv")

require(ggplot2)
require(mosaicData)

```

a. Construct a visualization that helps you understand commute times for people in each City. What can be said about how the distributions of commute times compare between the two cities?

```{r}
ggplot(data=Commuter)+
  geom_density(aes(x=Time, fill=City), alpha=0.5)+
  facet_grid(.~City)+
  scale_fill_manual(values=c("skyblue2",
                             "tomato3"))
```

b. Construct a plot that will allow you to assess the relationship between distance, time, city, and sex. Comment on anything you are able to decipher from your visualization.

```{r}

ggplot(data = Commuter)+
  geom_point(aes(x=Distance, y=Time, 
                 color=City), alpha=0.5)+
  geom_smooth(aes(x=Distance, y=Time, 
                 color=City))+
  facet_grid(.~Sex, labeller = label_both)+
  scale_color_manual(values=c("skyblue2",
                             "tomato3"))

```

c. Construct a new variable of your choice. Then use this new variable (and any other variable(s) you'd like) to explore a relationship of interest.

# Question 2

You will be using the Births2015 data set for this question. This data set exists within the package mosaicData. Get acquainted with the data before proceeding. It incudes a day by day record of the number of births in the United States in 2015.

a. Make a time series graph of the number of births by date that distinguishes by day of week. Make appropriate labels.

```{r}
ggplot(data=Births2015)+
  geom_line(aes(x=date, y=births, color=wday))+
  scale_color_brewer("Day of Week",palette="Dark2")
```


b. Make a new variable, "holiday" in the data set that includes a selection of observed holidays in the United States. (HINT: Look at the top of page 4 of the Topic 4 notes to see how you can construct this variable. You will need a separate line of code for each of the dates listed below).

```{r, echo=FALSE}
date<-as.Date(c("January 1, 2015", "January 19, 2015",
                "April 3, 2015", "April 5, 2015",
                "May 25, 2015", "July 4, 2015",
                "September 7, 2015", "October 12, 2015",
                "November 11, 2015", "November 26, 2015",
                "December 25, 2015"), format="%B %d, %Y")
  
holiday<-c("New Year's Day", "Martin Luther King Jr. Day", "Good Friday", "Easter","Memorial Day","Independence Day", "Labor Day", "Columbus Day","Veterans Day", "Thanksgiving", "Christmas Day")

library(knitr)

holidays2015<-data.frame(date=date, Holiday=holiday)

kable(holidays2015)

```

```{r}
Births2015$holiday[Births2015$date=="2015-01-01"]<-"New Year's Day"
Births2015$holiday[Births2015$date=="2015-01-19"]<-"Martin Luther King Jr. Day"
Births2015$holiday[Births2015$date=="2015-04-03"]<-"Good Friday "
Births2015$holiday[Births2015$date=="2015-04-05"]<-"Easter"
Births2015$holiday[Births2015$date=="2015-05-25"]<-"Memorial Day"
Births2015$holiday[Births2015$date=="2015-07-04"]<-"Independence Day "
Births2015$holiday[Births2015$date=="2015-09-07"]<-"Labor Day"
Births2015$holiday[Births2015$date=="2015-10-12"]<-"Columbus Day"
Births2015$holiday[Births2015$date=="2015-11-11"]<-"Veterans Day"
Births2015$holiday[Births2015$date=="2015-11-26"]<-"Thanksgiving"
Births2015$holiday[Births2015$date=="2015-12-25"]<-"Christmas Day"
```


c. Construct a plot that utilizes geom\_label() (or geom\_text(), geom\_label\_repel(), etc.) to add in information about the holidays into your plot from part a. An example of a type of graph you might construct with this information is shown below:

```{r}
require(mosaicData)
require(ggrepel)

#This is a step that finds all dates that
#are holidays in the data set
#This step is not necessary but I
#think it helps to only add points for
#days that are holidays

require(dplyr)
Births2015 %>% 
  filter(!is.na(holiday))->holidays2015

ggplot(data=Births2015)+
  geom_line(aes(x=date, y=births,
                                  color=wday))+
  scale_color_brewer("Day of Week",palette="Dark2")+
  geom_label_repel(aes(x=date, y=births, label=holiday, color=wday), size=3)+
  geom_point(data=holidays2015, aes(x=date, y=births, color=wday))+
  ylab("Number of Births")+
  xlab("Date")
```

# Question 3

Construct two different visualizations that show how music sales have changed over time based on format type (some options include tile, area, dumbbell, line,...). Use the data set `musicsales.csv'. Describe any insights you find in the visualizations and describe which one you feel is a more successful visual. The data represents sales in millions of dollars of the each of the formats specified.

```{r, eval=TRUE, echo=FALSE}
musicsales <- read.csv("https://raw.githubusercontent.com/nazzstat/DataVisualization/master/musicsales.csv")
```

```{r, eval=FALSE, echo=TRUE}
musicsales <- read.csv("https://raw.githubusercontent.com/nazzstat/
                       DataVisualization/master/musicsales.csv")
```


```{r}

require(reshape2)

musicsales %>%
  melt(id="Year") -> musicsales_long

ggplot(data=musicsales_long)+
  geom_line(aes(x=Year, y=value, color=variable))+
  scale_color_brewer("Format Type", palette="Dark2")+
  ylab("Sales in Millions")

ggplot(data=musicsales_long)+
  geom_area(aes(x=Year, y=value, fill=variable), alpha=0.5)+
  scale_fill_brewer("Format Type", palette="Dark2")+
  ylab("Sales in Millions")

musicsales %>%
  mutate(Total=LP_EP+CD+Ringtones+Subscription+Cassette) %>% 
  melt(id="Year") -> musicsales_long2

musicsales_long2 %>% 
  mutate(variable=reorder(variable, -value)) -> musicsales_long2

ggplot(data=musicsales_long2)+
  geom_tile(aes(x=Year, y=variable, fill=value), color="white")+
  scale_fill_distiller("Total Sales (in thousands)",palette="RdYlGn", direction=1)+
  ylab("Format Type")


```

*I prefer the area chart as it does a nice job of showing the overall trend in music sales over time and how sales peaked in the mid 1990's. Additionally it does a nice job of still showing trends within each music format type.* 
